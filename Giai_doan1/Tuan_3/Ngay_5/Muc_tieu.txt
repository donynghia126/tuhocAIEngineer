ğŸ“… NgÃ y 19: Generators & yield
ğŸ¯ Má»¥c tiÃªu: Hiá»ƒu cÆ¡ cháº¿ "Sinh dá»¯ liá»‡u lÆ°á»i" (Lazy Evaluation) vÃ  viáº¿t hÃ m sinh sá»‘ vÃ´ táº­n.

ğŸ“š 1. LÃ½ thuyáº¿t: return vs yield
HÃ£y tÆ°á»Ÿng tÆ°á»£ng báº¡n Ä‘i Äƒn Pizza:

return (List thÆ°á»ng): Báº¡n gá»i 100 cÃ¡i bÃ¡nh. Báº¿p lÃ m xong cáº£ 100 cÃ¡i, bÃª ra bÃ n cÃ¹ng lÃºc. -> Háº¿t chá»— Ä‘á»ƒ (TrÃ n RAM), BÃ¡nh nguá»™i.

yield (Generator): Báº¡n gá»i "Cho 1 cÃ¡i". Báº¿p lÃ m 1 cÃ¡i, bÃª ra. Báº¡n Äƒn xong, gá»i tiáº¿p "Cho cÃ¡i ná»¯a". Báº¿p lÃ m tiáº¿p cÃ¡i thá»© 2. -> LuÃ´n nÃ³ng há»•i, tá»‘n Ã­t chá»—.

CÆ¡ cháº¿ yield: Khi gáº·p tá»« khÃ³a yield, hÃ m sáº½ TRáº¢ Vá»€ giÃ¡ trá»‹ nhÆ°ng KHÃ”NG Káº¾T THÃšC hÃ m. NÃ³ chá»‰ Táº M Dá»ªNG (Pause) vÃ  nhá»› tráº¡ng thÃ¡i á»Ÿ Ä‘Ã³. Láº§n sau gá»i, nÃ³ cháº¡y tiáº¿p tá»« chá»— Ä‘Ã³.

ğŸ’» BÃ i táº­p thá»±c hÃ nh
HÃ£y táº¡o file day19_generator.py.

ğŸŸ¢ BÃ i 1: Fibonacci VÃ´ Táº­n (Infinite Generator)
YÃªu cáº§u:

Viáº¿t hÃ m fibonacci_gen():

Khá»Ÿi táº¡o 2 sá»‘ Ä‘áº§u: a = 0, b = 1.

DÃ¹ng vÃ²ng láº·p vÃ´ táº­n while True.

yield a (Tráº£ vá» sá»‘ hiá»‡n táº¡i vÃ  táº¡m dá»«ng).

Cáº­p nháº­t a, b theo cÃ´ng thá»©c Fibonacci: a má»›i = b cÅ©, b má»›i = a cÅ© + b cÅ©.

CÃ¡ch dÃ¹ng (Cáº©n tháº­n treo mÃ¡y):

VÃ¬ hÃ m nÃ y vÃ´ táº­n, TUYá»†T Äá»I KHÃ”NG Ä‘Æ°á»£c list(fibonacci_gen()) hoáº·c for loop khÃ´ng cÃ³ Ä‘iá»ƒm dá»«ng.

HÃ£y dÃ¹ng hÃ m next() Ä‘á»ƒ láº¥y tá»«ng sá»‘.

Máº«u code (Báº¡n Ä‘iá»n tiáº¿p):

Python

def fibonacci_gen():
    a, b = 0, 1
    while True:
        # ... yield cÃ¡i gÃ¬ Ä‘Ã³ ...
        # ... tÃ­nh toÃ¡n a, b má»›i ...
        pass

# Sá»­ dá»¥ng
fibo = fibonacci_gen() # Khá»Ÿi táº¡o generator (ChÆ°a cháº¡y Ä‘Ã¢u!)

print(next(fibo)) # Láº¥y sá»‘ thá»© 1
print(next(fibo)) # Láº¥y sá»‘ thá»© 2
print(next(fibo)) # Láº¥y sá»‘ thá»© 3
# ... Muá»‘n láº¥y bao nhiÃªu tÃ¹y thÃ­ch ...
ğŸ”´ BÃ i 2: Giáº£ láº­p Data Loader (AI Context)
TÃ¬nh huá»‘ng: Giáº£ sá»­ báº¡n cÃ³ 10.000 file áº£nh cáº§n xá»­ lÃ½. Viáº¿t má»™t generator Ä‘á»ƒ chá»‰ load tá»«ng batch (lÃ´) nhá» (vÃ­ dá»¥ 3 áº£nh/láº§n).

YÃªu cáº§u:

Viáº¿t hÃ m batch_loader(data, batch_size).

DÃ¹ng vÃ²ng láº·p range bÆ°á»›c nháº£y batch_size Ä‘á»ƒ cáº¯t list data thÃ nh tá»«ng Ä‘oáº¡n nhá».

yield tá»«ng Ä‘oáº¡n nhá» Ä‘Ã³.

Test:

Python

my_data = ["áº¢nh 1", "áº¢nh 2", "áº¢nh 3", "áº¢nh 4", "áº¢nh 5", "áº¢nh 6", "áº¢nh 7"]
loader = batch_loader(my_data, batch_size=3)

for batch in loader:
    print(f"Äang train vá»›i batch: {batch}")
Káº¿t quáº£ mong muá»‘n: NÃ³ in ra 3 dÃ²ng, má»—i dÃ²ng chá»©a 1 list nhá» tá»‘i Ä‘a 3 pháº§n tá»­.